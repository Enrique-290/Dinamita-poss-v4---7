<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DINÁMITA POS v4.8 BODEGA</title>
  <meta name="theme-color" content="#111" />

  <!-- Íconos y Manifest PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" sizes="192x192" href="icon-192.png" />
  <link rel="icon" sizes="512x512" href="icon-512.png" />

  <!-- Estilos -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- ===== ENCABEZADO ===== -->
  <header>
    <button class="burger" id="btnBurger">☰</button>
    <div class="brand">
      <div class="brand-title">DINÁMITA POS v4.8 BODEGA</div>
      <span class="brand-badge">ROJO / NEGRO / BLANCO</span>
    </div>
    <div class="brand-sub">“Gracias por tu compra en Dinamita Gym 💥”</div>
  </header>

  <!-- ===== LAYOUT PRINCIPAL ===== -->
  <div class="layout">
    <!-- Menú lateral -->
    <aside>
      <div class="menu">
        <div class="group">Navegación</div>
        <button data-view="dashboard" class="active">🏠 Dashboard</button>
        <button data-view="inventario">📦 Inventario</button>
        <button data-view="bodega">📥 Bodega</button>
        <button data-view="clientes">👥 Clientes</button>
        <button data-view="historial">🧾 Historial</button>
        <button data-view="reportes">📈 Reportes</button>
        <button data-view="config">⚙️ Configuración</button>
        <button data-view="ticket">🧾 Ticket</button>
      </div>
    </aside>

    <!-- Contenido principal -->
    <main id="views">
      <!-- DASHBOARD -->
      <section id="view-dashboard" class="view show">
        <div class="panel">
          <div class="panel-title">🏠 Dashboard</div>
          <div id="dashStats" class="table"></div>
        </div>
      </section>

      <!-- INVENTARIO -->
      <section id="view-inventario" class="view">
        <div class="panel">
          <div class="panel-title">📦 Inventario</div>
          <div id="invTabla" class="table"></div>
        </div>
      </section>

      <!-- BODEGA -->
      <section id="view-bodega" class="view">
        <!-- Entrada -->
        <div class="panel">
          <div class="panel-title">📥 Bodega · Entrada de mercancía</div>
          <div class="grid-3">
            <div>
              <label>Producto</label>
              <input id="bodSearch" placeholder="🔎 Nombre / SKU" oninput="Bodega.buscarProducto(this.value)">
              <div id="bodResultados" class="list"></div>
            </div>
            <div>
              <label>Cantidad</label>
              <input id="bodQty" type="number" min="1" step="1" value="1">
            </div>
            <div>
              <label>Costo unitario (MXN)</label>
              <input id="bodCosto" type="number" min="0" step="0.01">
            </div>
            <div>
              <label>Proveedor</label>
              <input id="bodProveedor" placeholder="Opcional">
            </div>
            <div>
              <label>Fecha</label>
              <input id="bodFecha" type="date">
            </div>
            <div>
              <label>Notas</label>
              <input id="bodNotas" placeholder="Lote o detalles...">
            </div>
            <div class="col-span-3 right">
              <button class="btn small" onclick="Bodega.addToLote()">➕ Agregar al lote</button>
              <button class="btn small outline" onclick="Bodega.limpiar()">🧹 Limpiar</button>
            </div>
          </div>
        </div>

        <!-- Lote actual -->
        <div class="panel">
          <div class="panel-title">🧺 Lote actual</div>
          <div id="bodLote" class="table"></div>
          <div class="right mt-2">
            <button class="btn" onclick="Bodega.confirmarEntrada()">✅ Confirmar entrada</button>
          </div>
        </div>

        <!-- Listado -->
        <div class="panel">
          <div class="panel-title">🏷️ Listado de bodega</div>
          <div id="bodStockTabla" class="table"></div>
        </div>

        <!-- Historial -->
        <div class="panel">
          <div class="panel-title">📜 Historial de entradas y salidas</div>
          <div class="filters">
            <label>De <input type="date" id="bodIni"></label>
            <label>A <input type="date" id="bodFin"></label>
            <button class="btn small" onclick="Bodega.renderMovs()">Actualizar</button>
            <button class="btn small" onclick="Bodega.exportCSV()">📤 Exportar CSV</button>
          </div>
          <div id="bodTabla" class="table"></div>
        </div>

        <!-- Sumar piezas rápido -->
        <div class="panel">
          <div class="panel-title">⚡ Sumar piezas rápido</div>
          <div class="grid-3">
            <div>
              <label>Producto</label>
              <input id="bodQuickSearch" placeholder="🔎 Nombre / SKU" oninput="Bodega.buscarProducto(this.value, true)">
              <div id="bodQuickResultados" class="list"></div>
            </div>
            <div>
              <label>+ Piezas</label>
              <input id="bodQuickQty" type="number" min="1" step="1" value="1">
            </div>
            <div class="right">
              <label>&nbsp;</label>
              <button class="btn" onclick="Bodega.sumarRapido()">➕ Sumar al stock</button>
            </div>
          </div>
        </div>
      </section>

      <!-- CLIENTES -->
      <section id="view-clientes" class="view">
        <div class="panel">
          <div class="panel-title">👥 Clientes</div>
          <div class="grid-3">
            <div><label>Nombre</label><input id="cliNombre" placeholder="Nombre completo"></div>
            <div><label>Teléfono</label><input id="cliTel" placeholder="+52 ..."></div>
            <div><label>Email</label><input id="cliEmail" placeholder="correo@dominio.com"></div>
            <div class="col-span-3 right">
              <button class="btn small" onclick="Clientes.agregar()">➕ Agregar</button>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">Listado de clientes</div>
          <input id="cliSearch" placeholder="🔎 Buscar cliente" oninput="Clientes.renderTabla(this.value)">
          <div id="cliTabla" class="table"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal de transferencia -->
  <div id="modalTransfer" class="modal hidden" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-head">
        <h3>🔄 Transferir a Inventario</h3>
        <button class="icon-btn" onclick="Bodega.closeTransfer()">✕</button>
      </div>
      <div class="modal-grid">
        <label>SKU<input id="trSku" readonly></label>
        <label>Producto<input id="trNombre" readonly></label>
        <label>En bodega<input id="trEnBodega" readonly></label>
        <label>Cantidad<input id="trQty" type="number" min="1"></label>
        <label class="col-span-3"><input type="checkbox" id="trUpdCosto"> Actualizar costo</label>
        <label class="col-span-3">Notas<input id="trNotas" placeholder="Opcional"></label>
      </div>
      <div class="actions">
        <button class="btn" onclick="Bodega.confirmTransfer()">✅ Transferir</button>
        <button class="btn outline" onclick="Bodega.closeTransfer()">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(() => console.log('✅ Service Worker registrado'))
        .catch(err => console.error('SW error', err));
    }
  </script>
</body>
</html>
